---
import '../styles/global.css';
import { Font } from 'astro:assets';

import { SITE_TITLE, SITE_DESCRIPTION } from '../consts';
import Header from './Header.astro';
import Footer from './Footer.astro';
import Head from './Head.astro';

type Props = {
  title?: string;
  description?: string;
  class?: string;
};

const { title = SITE_TITLE, description = SITE_DESCRIPTION, class: className } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <Head title={title} description={description} />

    <!-- Fonts -->
    <Font cssVariable="--font-general-sans" preload />
    <Font cssVariable="--font-dm-sans" preload />
    <Font cssVariable="--font-jetbrains-mono" preload />

    <!-- Prevent flash of unstyled content -->
    <script is:inline>
      (function() {
        const validThemes = ['cloud', 'cloud-dark', 'terminal'];
        let theme = localStorage.getItem('theme');
        if (!theme || !validThemes.includes(theme)) {
          theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'cloud-dark' : 'cloud';
        }
        document.documentElement.setAttribute('data-theme', theme);
      })();
    </script>
  </head>
  <body class="min-h-screen flex flex-col bg-background text-foreground antialiased">
    <Header />

    <main class:list={["flex-1", className]}>
      <slot />
    </main>

    <Footer />
  </body>
</html>
