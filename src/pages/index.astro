---
import { getCollection } from 'astro:content';
import Layout from '../components/Layout.astro';
import HeroSection from '../components/home/HeroSection.astro';
import AboutSection from '../components/home/AboutSection.astro';
import ProjectsSection from '../components/home/ProjectsSection.astro';
import BlogSection from '../components/home/BlogSection.astro';
import ContactSection from '../components/home/ContactSection.astro';
import {
  GITHUB_PROFILE_LINK,
  LINKEDIN_PROFILE_LINK,
  MAIL_PROFILE_LINK,
} from '../consts';

// Get latest blog posts
const allPosts = await getCollection('posts');
const latestPosts = allPosts
  .sort((a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime())
  .slice(0, 3);

// Skills/expertise areas based on real experience
const expertise = [
  {
    category: 'Frontend Core',
    skills: ['React', 'TypeScript', 'JavaScript', 'Next.js', 'Vue.js'],
  },
  {
    category: 'Architecture & DX',
    skills: ['Frontend Architecture', 'Performance', 'CI/CD', 'Testing', 'Webpack'],
  },
  {
    category: 'Full-Stack',
    skills: ['Node.js', 'GraphQL', 'REST APIs', 'PHP', 'SQL'],
  },
  {
    category: 'Tools & Practices',
    skills: ['Git', 'Docker', 'Agile', 'Code Review', 'Remote Teams'],
  },
];

// Real projects/achievements based on experience
const projects = [
  {
    title: 'SaaS Platform Frontend',
    description: 'Leading frontend development for a complex, long-living SaaS platform at Apliteni. Focus on performance optimization, clean architecture, and developer experience improvements.',
    tags: ['React', 'TypeScript', 'Performance', 'Architecture'],
    metrics: '4+ years of continuous development',
  },
  {
    title: 'GraphQL Backend & Client Apps',
    description: 'Led the development of an Apollo GraphQL server and created multiple client applications using Nuxt.js framework at ConstLab.',
    tags: ['GraphQL', 'Apollo', 'Nuxt.js', 'Node.js'],
    metrics: 'Full-stack architecture ownership',
  },
  {
    title: 'Legacy Frontend Migration',
    description: 'Migrated legacy frontends to modern React/TypeScript stack, introduced CI/CD automation to speed up development cycles.',
    tags: ['React', 'TypeScript', 'CI/CD', 'Migration'],
    metrics: 'Streamlined dev workflows',
  },
];

// Calculate years of experience (started May 2010)
const startYear = 2010;
const yearsExperience = new Date().getFullYear() - startYear;
---

<Layout>
  <HeroSection yearsExperience={yearsExperience} />
  <AboutSection yearsExperience={yearsExperience} expertise={expertise} />
  <ProjectsSection projects={projects} githubProfileLink={GITHUB_PROFILE_LINK} />
  <BlogSection latestPosts={latestPosts} githubProfileLink={GITHUB_PROFILE_LINK} />
  <ContactSection mailProfileLink={MAIL_PROFILE_LINK} linkedinProfileLink={LINKEDIN_PROFILE_LINK} />
</Layout>
